# Gitleaks configuration for Automotive MCP
# Prevents accidental commits of secrets, API keys, tokens

[extend]
useDefault = true

[allowlist]
description = "Allowlist for false positives"
paths = [
  '''package-lock\.json''',
  '''\.git/''',
  '''node_modules/''',
  '''dist/''',
  '''data/automotive\.db''',
]

# Allow specific patterns that are not actually secrets
regexes = [
  '''(example|sample|test|mock|dummy)''',
  '''Co-Authored-By:''',
]

[[rules]]
id = "npm-token"
description = "NPM access token"
regex = '''npm_[A-Za-z0-9]{36}'''
tags = ["key", "npm"]

[[rules]]
id = "github-token"
description = "GitHub token"
regex = '''gh[pousr]_[A-Za-z0-9]{36,255}'''
tags = ["key", "github"]

[[rules]]
id = "generic-api-key"
description = "Generic API key"
regex = '''(?i)(api[_-]?key|apikey)['\"]?\s*[:=]\s*['\"]?[A-Za-z0-9]{20,}'''
tags = ["key", "api"]

[[rules]]
id = "private-key"
description = "Private cryptographic key"
regex = '''-----BEGIN (?:RSA|EC|OPENSSH|PGP) PRIVATE KEY-----'''
tags = ["key", "private"]
